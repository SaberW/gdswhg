<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head th:include="guangdong/public/resource :: copy"></head>
<body>
<link rel="stylesheet" th:href="${basePath}+'/assets/css/brand/brand.css'" >
<link rel="stylesheet" th:href="${basePath}+'/assets/css/public/detail.css'" >
<div th:include="guangdong/public/leftBar :: copy"></div>
<div id="page">
    <div class="mui-content">
        <div class="pic-detail">
            <!--品牌名称-->
            <div class="brand-name" id="brand-name">
                <!--<div class="img">
                    <p>品牌名称</p>
                    <a href="#">
                        <img class="lazy" src="http://mpic.tiankong.com/bbd/0e1/bbd0e1190ec0ae9e134732eeb4e4135e/640.jpg">
                    </a>
                </div>-->
            </div>
            <!--品牌名称-->
            <!--品牌详情导航-->
            <div class="brand-nav mui-row">
                <div class="mui-col-sm-4 mui-col-xs-4 active">
                    <a href="javascript:void(0)">介绍</a>
                </div>
                <div class="cl1"></div>
                <div class="mui-col-sm-4 mui-col-xs-4">
                    <a href="javascript:void(0)">品牌活动</a>
                </div>
                <div class="cl2"></div>
                <div class="mui-col-sm-4 mui-col-xs-4">
                    <a href="javascript:void(0)">品牌风采 <i class="icon iconfont icon-jiantou"></i></a>
                </div>
            </div>
            <!--品牌详情导航-->
            <!--品牌介绍-->
            <div class="brand-nav-content on" id="recommend">
                <!--<div class="brand-nav-content introduce">
                    <div class="describe">
                        <h2>数字展馆的标题</h2>
                        <div class="describe-content">尽管数字博物馆在中国只有一二十年的探索发展历程，但在强大网络技术的支持下它却对传统博物馆产生了较大影响和冲击。数字博物馆是要替代或是削弱传统博物馆职能还是促进其发展，传统博物馆如何面对数字博物馆带来的变化，数字博物馆与传统博物馆之间到底是一种什么样的关系，这是在弄清楚数字博物馆概念后接下来要面对的另一重要问题。否则，数字博物馆建设就将失去动力和方向。数字博物馆除了缺乏实体博物馆的一些特点外，还存在数字化信息贮存载体寿命有限；数字化方式存贮的信息极易受到外力（磁场、计算机病毒、黑客侵入等）干扰、破坏；数字化信息很容易下载和复制，知识产权难以保障等等不足。而实体博物馆则除了不具备数字博物馆的那些特点外，还存在着藏品展示空间有限、展示内容更换周期长、展示手段单一、互动性差、与观众沟通交流困难等缺陷。与实体博物馆相比较，“数字博物馆具有信息实体虚拟化、信息资源数字化、信息传递网络化、信息利用共享化、信息提供智能化、信息展示多样化等特点”。在这里，最为关键的是信息实体虚拟化，即数字博物馆的一切活动，都是对实体博物馆工作职能的虚拟体现，都以实体博物馆为依托，同时又反过来作用于实体博物馆，是对实体博物馆职能的拓展和延伸。</div>
                    </div>
                </div>-->
            </div>
            <!--品牌介绍-->

            <!--品牌活动-->
            <div class="brand-nav-content">
                <div class="name">
                    <div class="tag mui-clearfix" id="activity">
                        <!--<div class="tag-l">
                            <div class="img">
                                <img class="lazy" src="http://mpic.tiankong.com/bbd/0e1/bbd0e1190ec0ae9e134732eeb4e4135e/640.jpg"/>
                                <p>余票：<span>1000</span></p>
                            </div>
                            <div class="info">
                                <h4>哈哈</h4>
                                <p>时间：&nbsp;<span>2017-12-01</span></p>
                                <p>地点：&nbsp;<span>广东省会展中心</span></p>
                            </div>
                        </div>-->
                    </div>
                </div>
            </div>
            <!--品牌活动-->

            <!--品牌风采-->
            <div class="brand-nav-content">
                <div class="wrapper-detail" >
                    <div class="wrapper-detail-box">
                        <div th:include="guangdong/resource/publicres :: copy" id="res-box"></div>
                    </div>
                </div>
            </div>
            <!--品牌风采-->
        </div>
    </div>
</div>
<input type="hidden" id="temp_type" value="35">
<script type="text/javascript" th:inline="javascript">
    var id = dataInit.getUrlParam("id");
    $(document).ready(function (){
        //加载品牌详情
        showDetail();
        //加载品牌关联活动列表
        brandActList();
        //加载品牌活动资源
        mui(".brand-nav").on("tap",".mui-col-sm-4.mui-col-xs-4",function(){
            $(this).addClass("active").siblings().removeClass("active");
            $(".brand-nav-content").eq($(".brand-nav .mui-col-sm-4.mui-col-xs-4").index(this)).addClass("on").siblings().removeClass("on");
        })
    });
    function showDetail(){
        dataInit.ajax({
            api: [[${apiPath.ppdetail}]],
            params: {
                id: id
            }, fn: function(data){
                if(data && data.code == 0){
                    var model = data.data;
                    var img = data.imgPath + dataInit.getBigImage(model.picture);
                    $("#brand-name").html('');
                    $("#recommend").html('');
                    // #brand-name的内容
                    var html = '<div class="img">'+
                        '<p>'+model.name+'</p>'+
                        '<a href="#">'+
                        '<img class="lazy" src="'+img+'">'+
                        '</a>'+
                        '</div>';
                    $("#brand-name").html(html);

                    // #recommend的内容 (列表项之一)
                    var html1 = '<div class="introduce">'+
                        '    <div class="describe">'+
                        '        <h2 style="text-align: center">'+model.name+'</h2>'+
                        '        <div class="describe-content">'+model.introduction+'</div>'+
                        '    </div>'+
                        '</div>';
                    $("#recommend").html(html1);
                }else {
                    mui.toast(data.msg);
                }
            }
        })

    }

    function brandActList(){
        dataInit.ajax({
            api: [[${apiPath.ppActList}]],
            params: {
                id: id,
                cultid: $.cookie('cultid'),
                index: 1,
                size: 4
            },
            fn: function(data){
                if(data.rows && data.code == 0){
                    var html = '';
                    for(var i in data.rows){
                        var model = data.rows[i];
                        var liststate=model.liststate;
                        var img = data.imgPath + dataInit.getBigImage(model.imgurl);
                        var begin = moment(model.starttime).format('YYYY-MM-DD');
                        var end = moment(model.endtime).format('YYYY-MM-DD');
                        var time = begin + ' ~ ' + end;
                        if(begin==end){
                            time=begin;
                        }

                        html += '        <div class="tag-l">'+
                            '            <div class="img">'+
                            '                <img class="lazy" src="'+img+'"/>';
                          if(liststate&&liststate==1){
                              html += '<p>余票：<span>'+model.ticketnum+'</span></p>';
                          }
                        html +=  '            </div>'+
                            '            <div class="info">'+
                            '                <h4>'+model.name+'</h4>'+
                            '                <p>时间：&nbsp;<span>'+time+'</span></p>'+
                            '                <p>地点：&nbsp;<span>'+model.address+'</span></p>'+
                            '            </div>'+
                            '           <a href="../act/detail?id='+model.id+'"></a>'+
                            '        </div>';
                    }
                    if(html){
                        $("#activity").html(html);
                    }else{
                        $("#activity").html('<div class="newbility-no-msg2"></div>');
                    }
                }
            }
        });
    }

    //给消息过滤HTML标签
    function removeHTMLTag(str) {
        //str = str.replace(/<\/?[^>]*>/g,''); //去除HTML tag
        str = str.replace(/[ | ]*\n/g,'\n'); //去除行尾空白
        //str = str.replace(/\n[\s| | ]*\r/g,'\n'); //去除多余空行
        str=str.replace(/&nbsp;/ig,'');//去掉&nbsp;
        return str;
    }
</script>
</body>
</html>
