<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head th:include="guangdong/public/resource :: copy"></head>
<body>
<link th:href="${basePath}+'/assets/style/index/index.css'" rel="stylesheet">
<script th:src="${basePath}+'/assets/js/public/sly.js'" type="text/javascript"></script>
<input type="hidden" name="history_url" th:value="${temp_url}">

<style>
    div.banner {
        height: 430px;
        width: 100%;
        position: relative;
        overflow: hidden;
    }
    div.banner .big-banner{
        height: 430px;
        width: 1920px;
        top: auto;
        left: 50%;
        position: absolute;
    }
    div.banner .big-banner .banner-count{
        width: 1920px;
        height: 430px;
        left: -960px;
        right: auto;
        position: absolute;
    }
    div.banner .big-banner .banner-count li{
        width: 1920px;
        height: 430px;
        float: left;
        cursor: pointer;
        position: relative;
        background-position: 50% 0%;
        background-repeat: no-repeat;
    }
    div.banner .big-banner .banner-count li a{
        position: absolute;
        display: block;
        width: 100%;
        height: 100%;
        top: 0px;
        left: 0px;
    }

    div.banner div.pages{
        position: absolute;
        top: 30px;
        left: 0px;
        width: 100%;
        height: 5px;
        text-align: center;
    }
    div.banner div.pages span{
        display: inline-block;
        width: 35px;
        height: 10px;
        margin: 0 5px;
        background: #fff;
        border-radius: 10px;
        cursor: pointer;
    }
    div.banner div.pages span.active{
        background: #ffbe2c;
    }
</style>

<div class="wrapper clearfix">
    <div class="content">
        <!--公共主头部开始-->
        <div id="header" th:include="guangdong/public/header :: copy"></div>
        <!--公共主头部结束-->
        <!--大广告开始-->
        <!--<div class="big-bg" style="visibility: hidden"></div>-->
        <!--大广告结束-->
        <!--首页轮播开始-->
        <div class="banner">
            <div class="big-banner">
                <div class="banner-count">
                    <ul id="showLbt">

                    </ul>
                </div>
            </div>
            <div class="pages"></div>
        </div>
        <!--首页轮播结束-->
        <!--资讯开始-->
        <div class="news-cont clearfix">
            <div class="left-cont">
                <ul>
                    <!--<li class="clearfix">
                        <div class="date">
                            <p class="d">21</p>
                            <p class="y-m">2017-10</p>
                        </div>
                        <div class="info">
                            <h2>
                                <a href="#" target="_blank">这是一个标题</a>
                            </h2>
                            <p>这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~</p>
                        </div>
                    </li>
                    <li class="clearfix">
                        <div class="date">
                            <p class="d">21</p>
                            <p class="y-m">2017-10</p>
                        </div>
                        <div class="info">
                            <h2>
                                <a href="#" target="_blank">这是一个标题</a>
                            </h2>
                            <p>这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~最多显示两排</p>
                        </div>
                    </li>-->
                </ul>
            </div>
            <div class="right-cont">
                <div class="title">新闻资讯</div>
                <ul>
                    <!--<li>
                        <a href="#" target="_blank"></a>
                        <h2>这又是一个标题而以，最多显示两排~~hohoho~~</h2>
                        <p>2017-10-26</p>
                    </li>
                    <li>
                        <a href="#" target="_blank"></a>
                        <h2>这又是一个标题而以，最多显示两排~~hohoho~~</h2>
                        <p>2017-10-26</p>
                    </li>
                    <li>
                        <a href="#" target="_blank"></a>
                        <h2>这又是一个标题而以，最多显示两排~~hohoho~~</h2>
                        <p>2017-10-26</p>
                    </li>-->
                </ul>
            </div>
            <div class="show-more">
                <a th:href="${basePath}+'/news/list'">查看更多<i class="icon iconfont icon-enter"></i></a>
            </div>
        </div>
        <!--资讯结束-->
        <!--一楼开始-->
        <div class="part-1">
            <div class="ks-cont">
                <div class="index-title">
                    <h2>文化专题</h2>
                    <a th:href="${basePath}+'/whzt/recomment'" target="_blank" class="more">查看更多<i class="icon iconfont icon-enter"></i></a>
                </div>
                <div class="main-cont"  id="part-1-ks-cont">
                    <ul class="clearfix">
                        <!--<li class="active">
                            <div class="li-cont">
                                <div class="img">
                                    <img th:src="${basePath}+'/assets/img/img_demo/qw-01.jpg'" alt="demo">
                                </div>
                                <div class="info">
                                    <h2>这是一个只有一行的标题</h2>
                                    <p>这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~显示多排</p>
                                    <a class="next-btn" href="#" target="_blank">了解详情</a>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="li-cont">
                                <div class="img">
                                    <img th:src="${basePath}+'/assets/img/img_demo/qw-01b.jpg'" alt="demo">
                                </div>
                                <div class="info">
                                    <h2>这是一个只有一行的标题</h2>
                                    <p>这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~显示多排</p>
                                    <a class="next-btn" href="#" target="_blank">了解详情</a>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="li-cont">
                                <div class="img">
                                    <img th:src="${basePath}+'/assets/img/img_demo/qw-01c.jpg'" alt="demo">
                                </div>
                                <div class="info">
                                    <h2>这是一个只有一行的标题</h2>
                                    <p>这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~显示多排</p>
                                    <a class="next-btn" href="#" target="_blank">了解详情</a>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="li-cont">
                                <div class="img">
                                    <img th:src="${basePath}+'/assets/img/img_demo/qw-01.jpg'" alt="demo">
                                </div>
                                <div class="info">
                                    <h2>这是一个只有一行的标题</h2>
                                    <p>这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~显示多排这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~显示多排这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~显示多排这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~显示多排</p>
                                    <a class="next-btn" href="#" target="_blank">了解详情</a>
                                </div>
                            </div>
                        </li>-->
                    </ul>
                    <div class="ks-btn prev">
                        <i class="icon iconfont icon-return"></i>
                    </div>
                    <div class="ks-btn next">
                        <i class="icon iconfont icon-enter"></i>
                    </div>
                </div>
            </div>
        </div>
        <!--一楼结束-->
        <!--二楼开始-->
        <div class="part-2">
            <div class="ks-cont">
                <div class="index-title">
                    <h2>艺术人才</h2>
                    <a th:href="${basePath}+'/ysrc/list'" target="_blank" class="more">查看更多<i class="icon iconfont icon-enter"></i></a>
                </div>
                <div class="main-cont"  id="part-2-ks-cont">
                    <ul class="clearfix">
                        <!--<li>
                            <a href="#" target="_blank"></a>
                            <div class="img">
                                <img th:src="${basePath}+'/assets/img/userCenter/demo2.png'" alt="demo">
                            </div>
                            <div class="info">
                                <h2>刘伟强</h2>
                                <p class="tag">香港蛊惑仔系列电影导演</p>
                                <p class="desc">这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~显示多排这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~显示多排这是一段描述~</p>
                                <p class="show">了解详情</p>
                            </div>
                        </li>
                        <li class="active">
                            <a href="#" target="_blank"></a>
                            <div class="img">
                                <img th:src="${basePath}+'/assets/img/userCenter/faceDemo.jpg'" alt="demo">
                            </div>
                            <div class="info">
                                <h2>刘伟强</h2>
                                <p class="tag">香港蛊惑仔系列电影导演</p>
                                <p class="desc">这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~显示多排这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~显示多排这是一段描述~</p>
                                <p class="show">了解详情</p>
                            </div>
                        </li>
                        <li>
                            <a href="#" target="_blank"></a>
                            <div class="img">
                                <img th:src="${basePath}+'/assets/img/userCenter/demo2.png'" alt="demo">
                            </div>
                            <div class="info">
                                <h2>刘伟强</h2>
                                <p class="tag">香港蛊惑仔系列电影导演</p>
                                <p class="desc">这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~显示多排这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~这是一段描述~显示多排这是一段描述~</p>
                                <p class="show">了解详情</p>
                            </div>
                        </li>-->
                    </ul>
                </div>
            </div>
        </div>
        <!--二楼结束-->
        <!--三楼开始-->
        <div class="part-3">
            <div class="ks-cont">
                <div class="index-title bd">
                    <h2>群文资源</h2>
                    <a th:href="${basePath}+'/qwzy/index'" target="_blank" class="more">查看更多<i class="icon iconfont icon-enter"></i></a>
                </div>
                <div class="main-cont"  id="part-3-ks-cont">
                    <ul> </ul>
                </div>
            </div>
        </div>
        <!--三楼结束-->
    </div>
</div>
<!--底部开始-->
<div class="footer-container" id="footer" th:include="guangdong/public/footer :: copy"></div>
<!--底部结束-->
<script type="text/javascript" th:inline="javascript">

    $("#part-2-ks-cont ul").on('mouseover', "li",function(){
        $(this).addClass("active").siblings().removeClass("active");
    })


    $(function () {
        PageTool.init();
    });

    var PageTool = {
        bashPath: [[${basePath}]],
        brandlistUrl: [[${apiPath.brandlist}]],
        artistListURL: [[${apiPath.artistList}]],
        infolistURL: [[${apiPath.infolist}]],
        showAdverUrl: [[${apiPath.showAdver}]],

        params: {page: 1, pageSize: 3, cultid : $.cookie('cultid') || ''},

        init: function(){
            this.loadBlImg();
            this.loadZxList();
            this.loadZtList();
            this.loadRcList();
            this.loadQwzyList();
        },

        /**
         * 加载群文资源
         */
        loadQwzyList: function () {
            var _basePath = this.bashPath;
            dataInit.ajax({
                api: [[${apiPath.massResList}]],
                params: {"page":1, "pageSize":5, "cultid":$.cookie('cultid')},
                fn: function(data){
                    var li_html = '';
                    if(data.rows && $.isArray(data.rows)){
                        for(var i=0; i<data.rows.length; i++) {
                            var row = data.rows[i];
                            var restype = row.resourcetype;
                            var libid = row.libid;
                            var resid = row.resid;
                            var respicture = row.respicture;//图片地址
                            var resname = row.resname;//资源名称
                            var icon = '';//显示音频还是视频的图片
                            var download = '';//下载图标
                            if (restype == 'audio') {
                                icon = '<i class="icon iconfont icon-yinpin"></i>';
                                respicture = [[${basePath}]] + '/assets/img/public/audio.png';//音频图片
                            } else if (restype == 'video') {
                                icon = '<i class="icon iconfont icon-CombinedShape"></i>';
                            } else if (restype == 'img') {
                            } else {
                                download = '<div class="download">下载<i class="icon iconfont icon-download-copy"></i></div>';
                                //respicture = [[${basePath}]] + '/assets/img/public/file.png';//文档图片
                                respicture = [[${basePath}]] + dataInit.getFileTypeIcon(row.resurl, '/assets/img/brand/xiazai.jpg');
                            }
                            li_html += '\
                                <li class="i-'+i+'">\
                                    <a href="'+_basePath+'/qwzy/detail?libid='+libid+'&resid='+resid+'" target="_blank"></a>\
                                    <img src="'+respicture+'" alt="'+resname+'">\
                                    <div class="title-cont">'+resname+'</div>\
                                </li>\
                            ';
                        }
                    }
                    $('#part-3-ks-cont ul').html(li_html);
                }
            })
        },

        loadBlImg: function(){
            var me = this;
            var params = {
                /*type: 50,
                toproject: 'QWZY',
                cultid: $.cookie('cultid') || '0000000000000000'*/
                type: 9,
                city: $.cookie('city'),
                cultid: $.cookie('cultid')
            };

            //var big = $(".big-bg");

            $.post(me.showAdverUrl, params, function(data){
                /*if (!data || !data.rows || !data.rows.length) {
                    big.css("visibility", "visible");
                    return;
                }
                var imgPath = data.imgPath;
                if (data.rows.length >= 1){
                    var row = data.rows[0];
                    for(var i=0; i<data.rows.length; i++){
                        if (data.rows[i].crtdate > row.crtdate){
                            row = data.rows[i];
                        }
                    }
                    big.css("background-image", "url("+ imgPath + row.picture +")");
                    big.css("visibility", "visible");
                    big.css("background-position", "top center");
                    if (row.url && row.url != ''){
                        big.off().on("click", function(){
                           window.open(row.url);
                        });
                    }
                    return;
                }*/

                if (data.rows.length && data.code == 0) {
                    for (var i = 0; i < data.rows.length; i++) {
                        if(data.rows[i].url&&data.rows[i].url!=""){
                            $("#showLbt").append('<li style="background-image:url(' + data.imgPath + data.rows[i].picture + ')"><a href="' + data.rows[i].url + '"></a></li>');
                        }else{
                            $("#showLbt").append('<li style="background-image:url(' + data.imgPath + data.rows[i].picture + ')"><a href="javascript:void(0)"></a></li>');
                        }
                    }
                    if(data.rows.length>0){
                        $(".banner-count").sly({
                            itemNav: "forceCentered",
                            easing: "easeOutExpo",
                            pagesBar: ".pages",
                            pageBuilder:function (dom) {
                                return "<span></span>";
                            },
                            cycleBy: 'items',
                            horizontal: 1,
                            cycleInterval: 5000
                        });
                    }
                }else{
                    var defautimg = [[${basePath}]]+'/assets/img/public/qwbanner.jpg';
                    $("#showLbt").append('<li style="background-image:url('+defautimg+')"><a href="javascript:void(0)"></a></li>');
                }
            }, "JSON");
        },

        loadZxList: function () {
            var me = this;
            var params = {
                index: 1,
                size: 5,
                area: $("#area").val(), //区域
                city: $("#city").val(), //市
                province: $("#province").val(), //省
                cultid: $.cookie('cultid'),
                fromproject: "QWZY"
            };

            var UL_1 = $(".news-cont .left-cont ul");
            var UL_2 = $(".news-cont .right-cont ul");

            var litemp_1 = '<li class="clearfix">\
                        <div class="date">\
                            <p class="d">21</p>\
                            <p class="y-m">2017-10</p>\
                        </div>\
                        <div class="info">\
                            <h2>\
                                <a href="#" target="_blank">这是一个标题</a>\
                            </h2>\
                            <p>这是一段描述~这是一段描述</p>\
                        </div>\
                    </li>';
            var litemp_2 = '<li>\
                        <a href="#" target="_blank"></a>\
                        <h2>这又是一个标题而以，最多显示两排~~hohoho~~</h2>\
                        <p>2017-10-26</p>\
                    </li>';

            UL_1.empty();
            UL_2.empty();
            $.post(me.infolistURL, params, function(data){
                if (!data || !data.rows || !data.rows.length) {
                    return;
                }
                for(var i in data.rows) {
                    if (i>=5) break;
                    var row = data.rows[i];

                    if (i<2){
                        var LI = $(litemp_1);
                        LI.find(".date .d").text(moment(row.clnfcrttime).format("DD"));
                        LI.find(".date .y-m").text(moment(row.clnfcrttime).format("YYYY-MM"));
                        LI.find(".info a").text(row.clnftltle)
                                .attr("href", me.bashPath+"/news/detail?id="+row.clnfid);
                        LI.find(".info p").text(row.clnfintroduce);

                        UL_1.append(LI);
                    }else{
                        var LI = $(litemp_2);
                        LI.find("p").text(moment(row.clnfcrttime).format("YYYY-MM-DD"));
                        LI.find("h2").text(row.clnftltle);
                        LI.find("a").attr("href", me.bashPath+"/news/detail?id="+row.clnfid);

                        UL_2.append(LI);
                    }
                }
            }, "JSON");
        },

        loadZtList: function(){
            var me = this;

            var litemp = '<li>\
                            <div class="li-cont">\
                                <div class="img">\
                                    <img alt="">\
                                </div>\
                                <div class="info">\
                                    <h2></h2>\
                                    <p></p>\
                                    <a class="next-btn" href="#" target="_blank">了解详情</a>\
                                </div>\
                            </div>\
                        </li>';

            var UL = $("#part-1-ks-cont ul");
            UL.empty();
            $.post(me.brandlistUrl, me.params, function(data){
                if (!data || !data.rows || !data.rows.length) {
                    return;
                }
                var imgPath = data.imgPath;
                for(var i in data.rows) {
                    var row = data.rows[i];
                    var LI = $(litemp);
                    //LI.find("img").attr("src", imgPath + dataInit.getBigImage(row.imgurl));
                    LI.find("img").attr("src", imgPath + dataInit.getImage(row.imgurl, 750, 500));
                    LI.find(".info h2").text(row.title);
                    LI.find(".info p").text(removeHTMLTag(row.description));

                    LI.find("a").attr("href", me.bashPath+"/whzt/index?id=&brandid="+row.id);
                    UL.append(LI);
                }

                $('#part-1-ks-cont').sly({
                    itemNav: "smart",
                    prev: ".prev",
                    next: ".next",
                    horizontal: 1
                });
            }, "JSON");
        },

        loadRcList: function(){
            var me = this;

            var UL = $("#part-2-ks-cont ul");
            UL.empty();

            var litemp = '<li>\
                            <a href="#" target="_blank"></a>\
                            <div class="img">\
                                <img  alt="">\
                            </div>\
                            <div class="info">\
                                <h2></h2>\
                                <p class="tag">香港蛊惑仔系列电影导演</p>\
                                <p class="desc">这是一段描述~</p>\
                                <p class="show">了解详情</p>\
                            </div>\
                        </li>';

            $.post(me.artistListURL, me.params, function(data){
                if (!data || !data.rows || !data.rows.length) {
                    return;
                }
                var imgPath = data.imgPath;
                for(var i in data.rows) {
                    var row = data.rows[i];
                    var LI = $(litemp);
                    //LI.find("img").attr("src", imgPath+ dataInit.getSmallImage(row.imgurl));
                    LI.find("img").attr("src", imgPath+ dataInit.getImage(row.imgurl, 300, 200));
                    LI.find(".info h2").text(row.name);
                    LI.find(".info .tag").text(row.job);
                    LI.find(".info .desc").text(row.summary);

                    LI.find("a").attr("href", me.bashPath+"/ysrc/detail?id="+row.id);
                    UL.append(LI);
                }
            }, "JSON");
        }
    };



    function removeHTMLTag(str) {
        str = str.replace(/<\/?[^>]*>/g,''); //去除HTML tag
        str = str.replace(/[ | ]*\n/g,'\n'); //去除行尾空白
        //str = str.replace(/\n[\s| | ]*\r/g,'\n'); //去除多余空行
        str=str.replace(/&nbsp;/ig,'');//去掉&nbsp;
        return str;
    }

</script>
</body>
</html>