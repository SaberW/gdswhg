<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head th:include="guangdong/public/resource :: copy"></head>
<body>
<link rel="stylesheet" th:href="${basePath}+'/assets/style/news/news.css'">
<div class="wrapper clearfix">
    <div class="content">
        <!--公共主头部开始-->
        <div id="header" th:include="guangdong/public/header :: copy"></div>
        <!--公共主头部结束-->
        <!--主体开始-->
        <div class="container">
            <div class="brand-page">
                <div class="brand-page-content">
                    <div class="brand-page-title"><span>群文资讯</span></div>
                    <div class="news-page-list">
                        <ul>
                            <li>
                                <div class="timeCont">
                                    <p class="month">10/21</p>
                                    <p class="year">2017</p>
                                    <div class="circular"></div>
                                </div>
                                <div class="notice-list-info">
                                    <div class="arrow"></div>
                                    <div class="info">
                                        <h2><a href="detail?id=">文字文字文字文字文字</a></h2>
                                        <p>文字文字文字文字文字文字文字文字文字</p>
                                        <p>来源：<span style="margin-right: 10px">哈哈</span> 关键字：文字文字文字<span></span></p>
                                    </div>
                                </div>
                            </li>
                        </ul>
                        <!--分页开始 -->
                        <div class="green-black clearfix" id="artPagging" style="margin-bottom: 40px"></div>
                        <!--分页结束-->
                    </div>
                </div>
            </div>
        </div>
        <!--主体结束-->
    </div>
</div>
<!--底部开始-->
<div class="footer-container" id="footer" th:include="guangdong/public/footer :: copy"></div>
<!--底部结束-->
<a class="to-top"></a>
<script type="text/javascript" th:inline="javascript">
    $(document).ready(function () {
        showAre($.cookie("city"));
        dataPage();
    });
    function setActive(dom) {
        $(dom).parent('span').addClass("active").siblings().removeClass("active");
    }
    function dataPage(page, rows) {
        var params_page = page || 1;
        var params_rows = rows || 12;
        var params = {
            index: params_page,
            size: params_rows,
            cultid: cultid,
            fromproject: "QWZY",
            area: $("#area").val(), //区域
            city: $("#city").val(), //市
            province: $("#province").val()//, //省
            //type: "2017101296841730" //众筹资讯
        }
        dataInit.ajax({
            api: [[${apiPath.infolist}]],
            params: params,
            fn: function (data) {
                showModelList(data);
                dataInit.pageInit('artPagging', params_page, params_rows, data.total, dataPage);
            }
        })
        function showVenueArea(data) {
            $("#" +
                "").html("");
            var cate = data.rows;
            var adrList = $("#adrList");
            adrList.append("<span class='item active'><a href='javascript:void(0)' onclick='setArea(this," + null + ")'>全部</a></span>")
            for (var i in cate) {
                adrList.append("<span class='item'><a href='javascript:void(0)' onclick='setArea(this," + cate[i].id + ")'>" + cate[i].name + "</a></span>");
            }
        }

        function showModelList(data) {
            if (data.code == 0) {
                var model = data.rows;
                var _html = '';
                if (model.length > 0) {
                    for (var i in model) {
                        var newsContent = removeHTMLTag(model[i].clnfdetail);
                        var clnfsource = model[i].clnfsource ? model[i].clnfsource : '无';
                        var clnfkey = model[i].clnfkey ? model[i].clnfkey : '无';
                        _html += '<li>' +
                            '    <div class="timeCont">' +
                            '        <p class="month">' + moment(model[i].clnfcrttime).format("MM/DD") + '</p>' +
                            '        <p class="year">' + moment(model[i].clnfcrttime).format("YYYY") + '</p>' +
                            '        <div class="circular"></div>' +
                            '    </div>' +
                            '    <div class="notice-list-info">' +
                            '        <div class="arrow"></div>' +
                            '        <div class="info">' +
                            '            <h2><a href="detail?id=' + model[i].clnfid + '">' + model[i].clnftltle + '</a></h2>' +
                            '            <p>' + newsContent + '</p>' +
                            '            <p>来源：<span style="margin-right: 10px">' + clnfsource + '</span> 关键字：<span>' + clnfkey + '</span></p>' +
                            '        </div>' +
                            '    </div>' +
                            '</li>';
                    }
                    $(".news-page-list ul").html(_html);
                } else {
                    $(".news-page-list ul").html("<div class='public-no-message'></div>");
                }

            } else {
                rongDialog.init({ico: 2, type: 1, desc: data.msg});
            }
        }
    }

    //给消息过滤HTML标签
    function removeHTMLTag(str) {
        str = str.replace(/<\/?[^>]*>/g, ''); //去除HTML tag
        str = str.replace(/[ | ]*\n/g, '\n'); //去除行尾空白
        //str = str.replace(/\n[\s| | ]*\r/g,'\n'); //去除多余空行
        str = str.replace(/&nbsp;/ig, '');//去掉&nbsp;
        return str;
    }
</script>
</body>
</html>